{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function fetchPhotos(query, currentPage) {\n    const url = 'https://pixabay.com/api/';\n    const params = {\n        key: '44568681-27f71dafd313c70416816878f',\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 15,\n        page: currentPage,\n    };\n\n    try {\n    const { data } = await axios.get(url, { params });\n    return data;\n  } catch (error) {\n  }\n\n}","export function gallerryTemplate(imageData) {\n    return imageData.map(imageTemplate).join('');\n}\n\nfunction imageTemplate(image) {\n  return ` <li class=\"gallery-item\">\n    <a href=\"${image.largeImageURL}\" class=\"gallery-item-link\"\n    ><img\n      class=\"gallery-item-img\"\n      src=\"${image.webformatURL}\"\n      alt=\"${image.tags}\"\n      width=\"360\"\n  /></a>\n  <ul class=\"image-info-list\">\n    <li class=\"image-info-item\">\n      <p class=\"image-data-name\">Likes</p>\n      <p class=\"image-data\">${image.likes}</p>\n    </li>\n    <li class=\"image-info-item\">\n      <p class=\"image-data-name\">Views</p>\n      <p class=\"image-data\">${image.views}</p>\n    </li>\n    <li class=\"image-info-item\">\n      <p class=\"image-data-name\">Comments</p>\n      <p class=\"image-data\">${image.comments}</p>\n    </li>\n    <li class=\"image-info-item\">\n      <p class=\"image-data-name\">Downloads</p>\n      <p class=\"image-data\">${image.downloads}</p>\n    </li>\n  </ul>\n</li>`;\n}","import { fetchPhotos } from './js/pixabay-api';\nimport { gallerryTemplate } from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport closeIcon from './img/close.svg';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n\nconst formSearch = document.querySelector('.form-search');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 350,\n});\nconst btnLoadMore = document.querySelector('.js-btn-load');\nconst loadElem = document.querySelector('.js-loader');\n\nlet query = '';\nlet currentPage = 1;\nlet maxPage = 0;\nconst perPage = 15; \n\nformSearch.addEventListener('submit', submitActive);\n\nasync function submitActive(e){\n  e.preventDefault();\n  \n  query = e.target.elements.searchField.value.trim();\n  \n    if (!query) {\n      showError('Error query');\n        return;\n    }\n\n  currentPage = 1;\n    showLoader(loader);\n    hideLoadBtn();\n\n    try {\n      const data = await fetchPhotos(query, currentPage);\n      maxPage = Math.ceil(data.totalHits / perPage);\n\n            if (maxPage === 0) {\n              showError('Empty Result');\n              hideLoader(loader);\n              updateBtnStatus();\n              return;\n            } \n      const markup = gallerryTemplate(data.hits);\n      gallery.innerHTML = markup;\n      lightbox.refresh();\n    \n    } catch (err) {\n      showError(err);\n    }\n  \n\n  hideLoader(loader);\n  updateBtnStatus();\n}\n\n\n\nbtnLoadMore.addEventListener('click', async () => { \n  currentPage++; \n  hideLoadBtn();\n  showLoader(loader);\n\n  try {\n    const data = await fetchPhotos(query, currentPage);\n    const markup = gallerryTemplate(data.hits);\n    gallery.insertAdjacentHTML('beforeend', markup);\n    skipOldElement();\n  } catch {\n    console.log(error);\n    showError(error.message);\n  }\n  \n  hideLoader(loader);\n  updateBtnStatus();\n\n});\n\nfunction updateBtnStatus() {\n   if (currentPage >= maxPage) {\n     hideLoadBtn();\n\n    if (maxPage) {\n      iziToast.info({\n        title: 'The End!',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } else {\n    showLoadBtn();\n  }\n}\n\nfunction showError(message) {\n  iziToast.error({\n    title: 'Error',\n    message:  message,\n  });\n}\n\nfunction showLoadBtn() {\n  btnLoadMore.classList.remove('visually-hidden');\n}\nfunction hideLoadBtn() {\n  btnLoadMore.classList.add('visually-hidden');\n}\n\nfunction showLoader(element) {\n  element.classList.remove('visually-hidden');\n}\n\nfunction hideLoader(element) {\n  element.classList.add('visually-hidden');\n}\n\nfunction skipOldElement() {\n  const itemGallery = gallery.children[0];\n  const height = itemGallery.getBoundingClientRect().height;\n\n    scrollBy({\n    top: height * 3,\n    behavior: 'smooth',\n  });\n}\n"],"names":["fetchPhotos","query","currentPage","url","params","data","axios","gallerryTemplate","imageData","imageTemplate","image","formSearch","gallery","loader","lightbox","SimpleLightbox","btnLoadMore","maxPage","perPage","submitActive","showError","showLoader","hideLoadBtn","hideLoader","updateBtnStatus","markup","err","skipOldElement","iziToast","showLoadBtn","message","element","height"],"mappings":"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"}